# mcst_2025

Подготовил Пашенцев Павел Владимирович

## Задание 

### 1) Приоритетный шифратор

Описать на Verilog параметризованный модуль, реализующий следующую функциональность: на выходной порт position подаётся значение номера старшего ненулевого разряда данных с входного порта data. При реализации требуется использовать только тип данных wire. 

Входные порты: битовый вектор data разрядности DATA_W (задаётся параметром). 

Выходные порты: двоичное число position разрядности POS_W (задаётся параметром, по умолчанию может автоматически вычисляться из DATA_W). 

*Упрощение: реализуйте указанный модуль для разрядности входа data равной 16, разрядности выхода position равной 4

### 2) Буфер FIFO 

Описать на Verilog параметризованный модуль, реализующий функциональность буфера FIFO; размер буфера задаётся параметром FIFO_SIZE; разрядность данных задаётся параметром DATA_W. При подаче признака записи, данные помещаются в буфер, при подаче признака чтения – удаляются из него по принципу FIFO (First in, First out); признаки записи и чтения могут подаваться одновременно (в одном такте). 

Входные порты: однобитный признак write (значимость записи в буфер), данные записи datain разрядности DATA_W, однобитный признак read (значимость чтения из буфера), тактовый сигнал clock, признак сброса reset (активный высокий уровень). 

Выходные порты: значимые данные dataout разрядности DATA_W, однобитный признак значимости данных val, однобитный признак заполненности буфера full. 

*Упрощение: реализуйте указанный модуль для разрядности портов datain и dataout равной 10, и размера буфера (количества ячеек очереди) равной 6

## Выполнение

### 1) Приоритетный шифратор

В ходе разработке были получены файлы модуля [`priority_coder.v`](/priority_coder/priority_coder_wire.v) и тестбенча [`tb_priority_coder_wire.v`](/priority_coder/tb_priority_coder_wire.v). 

Был разработан модуль `priority_coder.v` с учетом требования использования только переменных типа wire. Приоритизация идет на старшую единицу. Если на вход не подается ни одна единица, то на выходе выдаются все единицы. 

Был разработан параметризируемый модуль устройства с конфигурацией DATA_W=16 и POS_W=4. 

#### RTL

Была получена RTL-моедель разрабатываемого модуля. 

![](/priority_coder/docs/RTL.png)

Рисунок 1. RTL-модель устройства

#### Оценка затраты аппаратных ресурсов

В ходе компиляции проекта была получена информация по потребляемым ресурсам. 

Как видно на рисунке 2, было использовано 17 ЛЭ и 20 пинов. Можно сделать вывод, что данная схема эффективно использует ресурсы, поскольку кол-во логических элементов сходится с кол-вом описываемых состояний  (17 = 16 (one-hot) + 1 (пустой)) и кол-во пинов сходится с кол-вом портов ввода/вывода модуля (20 = 16 (DATA_W) + 4 (POS_W)).

![](/priority_coder/docs/FS.png)

Рисунок 2. Результат компиляции

#### Верификация

Для верикации модуля был разработан тестбенч `tb_priority_coder_wire.v`. Его симуляция производилась программе Modelsim. 

Для упрощения отслеживания возможных ошибок была добавлена переменная expected, с которой происходит сравнение значение вывода. Также выводится корректность прохождения теста Pass/Fail. 

Рассматривались различные сценарии: на вход подается ни одно значение, на вход подется one-hot код, на вход подается код с несколькими единицами (проверяется приоритизация).

Как видно на рисунке 4, симуляция произошла успешно. 

![](/priority_coder/docs/Modelsim.png)

Рисукнок 3. Симуляция в Modelsim

![](/priority_coder/docs/Simulation.png)

Рисунок 4. Вывод результата симулции в консоль 

### 2) Буфер FIFO

В ходе разработке были получены файлы модуля [`fifo.v`](/fifo/fifo.v) и тестбенча [`tb_fifo.v`](/fifo/tb_fifo.v). 

Был разработан модуль `fifo.v`. Реализация основана на хранении регистра данных и выбора значения для вывода с помощью указателя вершины. 

Был разработан параметризируемый модуль устройства с конфигурацией DATA_W=10 и FIFO_SIZE=6. 

#### RTL

Была получена RTL-моедель разрабатываемого модуля. 

![](/fifo/docs/RTL.png)

Рисунок 1. RTL-модель устройства

#### Оценка затраты аппаратных ресурсов

В ходе компиляции проекта была получена информация по потребляемым ресурсам. 

Как видно на рисунке 2, для реализации модуля fifo было использовано 123 логических элементов и 26 пинов. Можно сделать вывод, что схема эффективно использует ресурсы, так как число логических элементов соответствует ожидаемому объёму регистрационной логики для хранения данных и реализации управляющих счетчиков (6×10 бит памяти FIFO, указатели и счётчик заполнения). Количество пинов также сопоставимо с количеством внешних портов модуля: это входы данных (10 бит), выходные данные (10 бит), управляющие сигналы (push, pop, clock, rst_n, full, val) и дополнительные служебные сигналы. Встроенная память и специализированные блоки FPGA не используются, что подтверждает компактность и простоту конструкции при малой глубине FIFO.

![](/fifo/docs/FS.png)

Рисунок 2. Результат компиляции

Также немаловажной характеристикой является максимальная тактовая частота, на которой может работать устройсто памяти. Ведь от этого могут возникнуть проблемы с синхронизацией внешними устройствами. В качестве аппаратной платформы был выбран чип 10M50DAF484C7G (DE10-Lite). В данном случае она составляет 374.95 MHz. 

![](/fifo/docs/Fmax.png)

Рисунок 3. Максимальная частота

#### Верификация

Для верикации модуля был разработан тестбенч `tb_fifo.v`. Его симуляция производилась программе Modelsim. 

Рассматривались различные сценарии: производится только запись в пустой буфер, производится только чтение из заполненного буфера, одновременно подаются признаки записи и чтения (проверяется корректность работы при одновременных операциях), выполняется попытка чтения из пустого буфера (проверяется отсутствие изменений и корректность сигнала val), производится запись в полностью заполненный буфер (оценивается работа признака full и блокировка лишних записей), а также последовательная запись и последующее последовательное чтение всех значений для проверки порядка выдачи данных (FIFO).

Как видно на рисунке 4, симуляция произошла успешно. 

![](/fifo/docs/Modelsim.png)

Рисукнок 3. Симуляция в Modelsim

![](/fifo/docs/Simulation.png)

Рисунок 4. Вывод результата симулции в консоль 